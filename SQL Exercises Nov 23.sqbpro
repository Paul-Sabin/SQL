<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Asus WebStorage/psabin@gmail.com/MySyncFolder/Data Science Course/DB Browser databases/Day2.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="150"/><column_width id="3" width="1438"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><current_table name="4,11:mainDepartments"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="Departments" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="71"/><column index="2" value="167"/><column index="3" value="94"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Employees" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="106"/><column index="2" value="102"/><column index="3" value="120"/><column index="4" value="142"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Manufacturers" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="62"/><column index="2" value="154"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="Products" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_"><sort/><column_widths><column index="1" value="62"/><column index="2" value="144"/><column index="3" value="63"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="SQL 1">CREATE TABLE IF NOT EXISTS Departments (
  Code INTEGER,
  Name TEXT NOT NULL,
  Budget decimal NOT NULL,
  PRIMARY KEY (Code)   
);

CREATE TABLE IF NOT EXISTS Employees (
  SSN INTEGER,
  Name varchar(255) NOT NULL ,
  LastName varchar(255) NOT NULL ,
  Department INTEGER NOT NULL , 
  PRIMARY KEY (SSN)   
);


INSERT INTO Departments(Code,Name,Budget) VALUES(14,'IT',65000);
INSERT INTO Departments(Code,Name,Budget) VALUES(37,'Accounting',15000);
INSERT INTO Departments(Code,Name,Budget) VALUES(59,'Human Resources',240000);
INSERT INTO Departments(Code,Name,Budget) VALUES(77,'Research',55000);

INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('123234877','Michael','Rogers',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('152934485','Anand','Manikutty',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('222364883','Carol','Smith',37);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('326587417','Joe','Stevens',37);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('332154719','Mary-Anne','Foster',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('332569843','George','ODonnell',77);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('546523478','John','Doe',59);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('631231482','David','Smith',77);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('654873219','Zacary','Efron',59);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('745685214','Eric','Goldsmith',59);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('845657245','Elizabeth','Doe',14);
INSERT INTO Employees(SSN,Name,LastName,Department) VALUES('845657246','Kumar','Swamy',14);

SELECT LastName
FROM Employees
--2.1
SELECT DISTINCT LastName
FROM Employees
--2.3
SELECT * 
FROM Employees
WHERE LastName='Smith'
--2.4
SELECT * 
FROM Employees
WHERE LastName='Smith' OR LastName='Doe'
--2.5
SELECT *
FROM Employees
WHERE Department=14
--2.6
SELECT *
FROM Employees
WHERE Department IN (37,77)
--2.7
SELECT *
FROM Employees
WHERE LastName LIKE 'S%'
--2.8
SELECT SUM(Budget) AS SumOfBudgets
FROM Departments
--2.9
SELECT Department, COUNT(SSN) AS Headcount
FROM Employees
GROUP BY Department
--2.10
SELECT *
FROM Employees
JOIN Departments ON Employees.Department=Departments.Code
--2.11
SELECT Employees.Name, LastName, Departments.Name, Departments.Budget 
FROM Employees
JOIN Departments ON Employees.Department=Departments.Code
--2.12
SELECT Employees.Name, LastName
FROM Employees
JOIN Departments ON Employees.Department=Departments.Code
WHERE Budget&gt;60000
--2.13
SELECT Name
FROM Departments
WHERE Budget &gt; (
	SELECT AVG(Budget)
	FROM Departments);
--2.14
--My solution
SELECT Departments.Name
FROM Departments
JOIN (
SELECT Department, COUNT(SSN) AS Headcount
FROM Employees
GROUP BY Department) AS HeadcountTable ON HeadcountTable.Department=Departments.Code
WHERE Headcount &gt;2	
--Easier way with HAVING
SELECT Departments.Name
FROM Departments
JOIN Employees ON Employees.Department = Departments.Code
GROUP BY Departments.Name
HAVING COUNT(Employees.SSN) &gt; 2;
-- 2.15 Select the name and last name of employees working for the two departments with lowest budget.
SELECT Name, LastName
FROM Employees
WHERE Department IN (
	SELECT Code
	FROM Departments
	GROUP BY Budget --No need to group by since 1 dept = 1 budget
	LIMIT 2	
	);
--Improvement by ChatGPT
SELECT Name, LastName
FROM Employees
WHERE Department IN (
    SELECT Code
    FROM Departments
    ORDER BY Budget ASC
    LIMIT 2
);
-- 2.16  Add a new department called &quot;Quality Assurance&quot;, with a budget of $40,000 and departmental code 11. 
-- And Add an employee called &quot;Mary Moore&quot; in that department, with SSN 847-21-9811.
INSERT INTO Departments
VALUES (11, 'Quality Assurance', 40000)
INSERT INTO Employees
VALUES (847219811, 'Mary', 'Moore', 11)
-- 2.17 Reduce the budget of all departments by 10%.
UPDATE Departments
SET Budget = Budget*0.9
-- 2.18 Reassign all employees from the Research department (code 77) to the IT department (code 14).
UPDATE Employees
SET Department = 14
WHERE Department = 77
-- 2.19 Delete from the table all employees in the IT department (code 14).
DELETE FROM Employees
WHERE Department = 14
-- 2.20 Delete from the table all employees who work in departments with a budget greater than or equal to $60,000.
DELETE FROM Employees
WHERE Department IN (
	SELECT Code
	FROM Departments
	WHERE Budget &gt;= 60000);
-- 2.21 Delete from the table all employees.
DELETE FROM Employees
</sql><current_tab id="0"/></tab_sql></sqlb_project>
